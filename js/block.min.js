function initPageScript(){initTocInPostPage(),initSearchInTagPage()}function initTocInPostPage(){var e=$(".post-toc");e.length>0&&($("ol.toc").children().length>5&&e.show(),$(window).scroll(function(){var t=$(window).scrollTop(),n=155-t;n>=10?e.css("top",n):e.css("top",10)}),$("#btn-list").click(function(){return 0==e.find(".toc").length?void Materialize.toast("本文没有目录",1500):void("none"==e.css("display")?(e.show(),e.addClass("animated fadeInRight"),setTimeout(function(){e.removeClass("animated fadeInRight")},1e3)):(e.addClass("animated fadeOutRight"),setTimeout(function(){e.removeClass("animated fadeOutRight"),e.hide()},1e3)))}),$("#btn-list-close").click(function(){e.addClass("animated fadeOutRight"),setTimeout(function(){e.removeClass("animated fadeOutRight"),e.hide()},1e3)}),$("#btn-to-top").click(function(){goToTop()}))}function initSearchInTagPage(){var e=$("#search");if(e.length>0){var t=$(".tag-cloud a");e.on("keyup blur",function(){t.each(function(){$(this).text().toLowerCase().indexOf(e.val().toLowerCase())>-1?$(this).show():$(this).hide()})})}}function initNProgress(){NProgress.start(),$(document).ajaxStop(function(){NProgress.done()})}function initFavicon(){var e=["/categories/代码/","/categories/日常/","/categories/研究/"],t=["/images/favicon/01.ico","/images/favicon/mario.ico","/images/favicon/book.ico"],n=0;for(n=0;n<e.length;n++)if(window.location.pathname==encodeURI(e[n])){$("#favicon").attr("href",t[n]);break}n==e.length&&$("#favicon").attr("href","/favicon.ico")}function initMenu(){$("#menu-categories").html("分类"),$("#menu-categories").addClass("grey darken-2"),$(".dropdown-button").dropdown({inDuration:300,outDuration:0,constrain_width:!0,hover:!1,gutter:0,belowOrigin:!0,alignment:"left"});var e="/categories/",t=decodeURI(window.location.pathname);if(t.substr(0,e.length)==e){var n=t.substring(e.length,t.length-1);$("#menu-categories").html(n),$("#menu-categories").removeClass("grey darken-2"),$("#menu-categories").css("background-color","#ab8c91")}}function initMousetrap(){Mousetrap.bind("right",function(){var e=$(".block-pagination a[rel='next']");e.trigger("click")}),Mousetrap.bind("left",function(){var e=$(".block-pagination a[rel='prev']");e.trigger("click")}),Mousetrap.bind("g g",function(){goToTop()}),Mousetrap.bind("G",function(){goToBottom()}),Mousetrap.bind("s",function(){Mousetrap.unbind("s"),$(document).off("click","a[data-pjax]"),$.getScript("/js/iamsorry.min.js").done(function(){setCurrentFun("shark")})})}function initHeaderImage(){var e=getRandomArr(BlockConfig.BANNER_START_NUM,BlockConfig.BANNER_END_NUM),t=0;$(".post .card-image img").each(function(){var n="/images/banner/"+e[t]+".jpg",o=$(this);$.ajax({type:"GET",url:n,success:function(e){o.attr("src",n)}}),t++})}function initContentImage(){$(".card-content img").materialbox()}function initModal(){$(".modal-trigger").leanModal({starting_top:"10%",ending_top:"30%"})}function initPjax(){null!=$.pjax&&(addPjaxAttr(),$(document).pjax("a[data-pjax]",".content",{fragment:".content",timeout:1e4}),$(document).on({"pjax:click":function(){$(".content").fadeOut(500),NProgress.start()},"pjax:start":function(){},"pjax:end":function(){$(".content").fadeIn(500),addPjaxAttr(),initPageScript(),initFavicon(),initMenu(),initHeaderImage(),initContentImage(),initModal()},"pjax:popstate":function(){}}))}function addPjaxAttr(){for(var e=[$(".page-number"),$(".extend"),$(".tag-cloud a")],t=0;t<e.length;t++)null!=e[t]&&e[t].attr("data-pjax","")}function notification(){var e=$("#btnSearchPanel");if(e.length>0&&e.click(function(){Materialize.toast("搜索功能施工中...",1500)}),!isMySite(document.referrer)){var t=today.getHours();if(0==t)Materialize.toast("这么晚了还不睡吗？",3e3);else if(1==t){Materialize.toast("现在已经1点了",3e3);var n=$("<img src='/images/expression/xiuxian1.jpg' width='140px' />");Materialize.toast(n,4e3)}else if(t>=2&&t<=4){Materialize.toast("这个时间点还没睡，莫非你也在修仙",3e3);var n=$("<img src='/images/expression/xiuxian2.jpg' width='140px' />");Materialize.toast(n,4e3)}}}function modal(){$("#keybinding-info").click(function(){})}function initLive2D(){0!=$("#glcanvas").length&&($(window).width()<1150||$.getScript("/js/live2d.min.js").done(function(){$.getScript("/js/live2d-helper.min.js").done(function(){loadModel()})}))}function loadModel(){live2DHelper=new Live2DHelper({canvas:"glcanvas"});var e=["01","02","03","04","05","06","07","08","09","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","33","34","35","36","37","38","39","40","41","43","44","45","46","47","48","49","50","52","53","54"];e=shuffle(e);var t="/live2d/asuna/asuna_"+e[0]+"/asuna_"+e[0]+".edit.model.json";console.log("[Live2D] 主电源连接完毕..."),live2DHelper.loadModel(t,function(){console.log("[Live2D] 交互界面连接..."),live2DHelper.startMotion("","3"),live2DHelper.startTurnHead(),followMouse(),console.log("[Live2D] 思考形态以中文作为基准，进行思维连接..."),welcome(),saySomething(),$("#glcanvas").hasClass("animated")||$("#glcanvas").addClass("animated fadeIn")})}function followMouse(){var e=!1;$("#glcanvas").mousedown(function(t){e=!0}).mouseup(function(t){e=!1}).mouseout(function(t){e=!1,null!=live2DHelper&&live2DHelper.viewPointer(0,0)}).mousemove(function(e){null!=live2DHelper&&live2DHelper.followPointer(e)})}function seeMenu(){var e=$("#glcanvas"),t=e.width(),n=e.height(),o=$(window).width(),i=$(window).height();console.log(t+" "+o+" "+n+" "+i),$("a[data-pjax]").mousemove(function(e){}).mouseout(function(e){null!=live2DHelper&&live2DHelper.viewPointer(0,0)})}function welcome(){var e;if(""!==document.referrer){var t=document.createElement("a");t.href=document.referrer,e='你好! 来自 <span style="color:#0099cc;">'+t.hostname+"</span> 的朋友";var n=t.hostname.split(".")[1];"baidu"==n?e='你好! 来自 百度搜索 的朋友<br>你是搜索 <span style="color:#0099cc;">'+t.search.split("&wd=")[1].split("&")[0]+"</span> 找到的我吗？":"so"==n?e='你好! 来自 360搜索 的朋友<br>你是搜索 <span style="color:#0099cc;">'+t.search.split("&q=")[1].split("&")[0]+"</span> 找到的我吗？":"google"==n&&(e='你好! 来自 谷歌搜索 的朋友<br>欢迎阅读 <span style="color:#0099cc;">『'+document.title.split(" - ")[0]+"』</span>")}else if(isMySite(window.location.href)){var o=(new Date).getHours();e=o>23||o<=5?"早点睡觉，才能有更好的精神去迎接新的一天":o>5&&o<=7?"早上好！一日之计在于晨，美好的一天就要开始了":o>7&&o<=11?"上午好！工作顺利嘛，不要久坐，多起来走动走动哦！":o>11&&o<=14?"中午了，工作了一个上午，现在是午餐时间！":o>14&&o<=17?"午后很容易犯困呢，今天的运动目标完成了吗？":o>17&&o<=19?"傍晚了！窗外夕阳的景色很美丽呢。":o>19&&o<=21?"晚上好，今天过得怎么样？":o>21&&o<=23?"已经这么晚了呀，早点休息吧，晚安~":"嗨~"}else e='欢迎阅读<span style="color:#0099cc;">『'+document.title.split(" - ")[0]+"』</span>";var i=JSON.parse(window.localStorage.getItem("enterCount")),a=0,o=Date.parse(new Date);null!=i&&i.expired+i.date>o?(a=i.count,i.count=a+1,a>=5&&(e='你在 <span style="color:#0099cc;">'+(o-i.date)/1e3+"s</span> 内刷新了这么多次，是想看我换装吗")):(i={},i.count=0,i.expired=6e4,i.date=o),window.localStorage.setItem("enterCount",JSON.stringify(i)),showMessage(e,6e3)}function saySomething(){var e=!0;$(document).on("copy",function(){showMessage("你都复制了些什么呀，转载要记得加上出处哦",5e3),e&&(live2DHelper.startMotion("","11"),e=!1)}),$.ajax({cache:!0,url:"/live2d/live2d-tips.json",dataType:"json",success:function(e){console.log("[Live2D] 连接没有异常"),$.each(e.mouseover,function(e,t){$(document).on("mouseover",t.selector,function(){isEmpty(t.expression)||null==live2DHelper||live2DHelper.setExpression(t.expression);var e=t.text;isEmpty(e)||(Array.isArray(t.text)&&(e=t.text[Math.floor(Math.random()*t.text.length+1)-1]),e=e.render({text:$(this).text()}),showMessage(e,3e3))})}),$.each(e.click,function(e,t){$(document).on("click",t.selector,function(){isEmpty(t.expression)||null==live2DHelper||live2DHelper.setExpression(t.expression);var e=t.text;isEmpty(e)||(Array.isArray(t.text)&&(e=t.text[Math.floor(Math.random()*t.text.length+1)-1]),e=e.render({text:$(this).text()}),showMessage(e,3e3))})}),console.log("[Live2D] 初次见面，我是结城明日奈。")},error:function(){console.log("%c[Live2D] 思维连接出现异常","color:red")}})}function showMessage(e,t){Array.isArray(e)&&(e=e[Math.floor(Math.random()*e.length+1)-1]),$(".live2d-tips").stop(),$(".live2d-tips").html(e).fadeTo(200,1),null===t&&(t=5e3),hideMessage(t)}function hideMessage(e){$(".live2d-tips").stop().css("opacity",1),null===e&&(e=5e3),$(".live2d-tips").delay(e).fadeTo(200,0)}function fun(){function e(){document.title=document[t]?"标题被我吃掉了 (°∀°)ﾉ - "+o:o}console.log("%c(。﹏。) 不要这么看人家，人家害羞\nCopyright © 2013-2017 Made with ♥ by huiyadanli","text-shadow: -2px 0 rgba(0, 255, 255, .5), 2px 0 rgba(255, 0, 0, .5)"),console.log("------------------------------------------------\n"),14==today.getDate()&&$("html").click(function(e){var t,n=18;heartClickCounter++,10==heartClickCounter?t=$("<b></b>").text("OωO"):20==heartClickCounter?t=$("<b></b>").text("(๑•́ ∀ •̀๑)"):30==heartClickCounter?t=$("<b></b>").text("(๑•́ ₃ •̀๑)"):40==heartClickCounter?t=$("<b></b>").text("(๑•̀_•́๑)"):50==heartClickCounter?t=$("<b></b>").text("（￣へ￣）"):60==heartClickCounter?t=$("<b></b>").text("(╯°口°)╯(┴—┴"):70==heartClickCounter?t=$("<b></b>").text("૮( ᵒ̌皿ᵒ̌ )ა"):80==heartClickCounter?t=$("<b></b>").text("╮(｡>口<｡)╭"):90==heartClickCounter?(t=$("<b></b>").text("( ง ᵒ̌皿ᵒ̌)ง⁼³₌₃"),Materialize.toast("Fuzzy magic!",3e3),$("p").css("color","transparent"),$("p").css("text-shadow","#111 0 0 5px")):100==heartClickCounter?t=$("<b></b>").text("(ꐦ°᷄д°᷅)"):heartClickCounter>100&&heartClickCounter<=105?t=$("<b></b>").text("(ꐦ°᷄д°᷅)"):(t=$("<i class='material-icons'>favorite</i>"),n=Math.round(14*Math.random()+6));var o=e.pageX,i=e.pageY;t.css({"z-index":9999,top:i-20,left:o,position:"absolute",color:"#E94F06","font-size":n,"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none"}),$("body").append(t),t.animate({top:i-180,opacity:0},1500,function(){t.remove()})});var t,n,o=document.title;"undefined"!=typeof document.hidden?(t="hidden",n="visibilitychange"):"undefined"!=typeof document.mozHidden?(t="mozHidden",n="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(t="webkitHidden",n="webkitvisibilitychange"),"undefined"==typeof document.addEventListener&&"undefined"==typeof document[t]||document.addEventListener(n,e,!1)}function getRandomNum(e,t){var n=t-e;return e+Math.round(Math.random()*n)}function getRandomArr(e,t){for(var n=[],o=0;o<=t-e;o++)n[o]=e+o;return shuffle(n),n}function shuffle(e){for(var t,n,o=e.length;0!=o;)n=Math.floor(Math.random()*o),o--,t=e[o],e[o]=e[n],e[n]=t;return e}function goToTop(){$("html, body").animate({scrollTop:0},500)}function goToBottom(){$("html, body").animate({scrollTop:$(document).height()},500)}function isEmpty(e){return"undefined"==typeof e||null==e||""==e}function isMySite(e){var t=!1;for(x in BlockConfig.SITE_URLS)if(e.indexOf(BlockConfig.SITE_URLS[x])>=0){t=!0;break}return t}function render(e,t){var n=/(\\)?\{([^\{\}\\]+)(\\)?\}/g;return e.replace(n,function(e,n,o,i){if(n||i)return e.replace("\\","");var a,r,s,c=o.replace(/\s/g,"").split("."),l=t;for(a=0,r=c.length;a<r;++a)if(s=c[a],l=l[s],void 0===l||null===l)return"";return l})}var BlockConfig={SITE_URLS:["localhost","127.0.0.1","huiyadanli.github.io","huiyadanli.coding.me"],BANNER_START_NUM:1,BANNER_END_NUM:22},today=new Date,heartClickCounter=0,live2DHelper;$(function(){initNProgress(),initPageScript(),initFavicon(),initMenu(),initMousetrap(),initHeaderImage(),initContentImage(),initModal(),initLive2D(),fun(),notification(),modal(),initPjax()}),String.prototype.render=function(e){return render(this,e)};